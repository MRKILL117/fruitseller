"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[224],{7224:(U,d,r)=>{r.r(d),r.d(d,{PaymentsModule:()=>O});var a=r(6019),g=r(850),c=r(7537),m=r(1435),p=r(3550),t=r(1514),u=r(6588),Z=r(7754),f=r(1843),T=r(6155),h=r(5749);const A=function(n){return{text:!1,startDate:!0,endDate:!0,options:n,optionsLabel:"Filtrar por estado"}};function _(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-filters",22),t.NdJ("onSearch",function(o){return t.CHM(e),t.oxw().GetOrders(o)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("timerTrigger",!0)("filters",t.VKq(2,A,e.orderStatuses))}}function v(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td",27),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(3).GoToOrder(l)}),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.qZA()}if(2&n){const e=i.$implicit;t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.status.name),t.xp6(2),t.Oqu(t.xi3(7,7,e.date,"dd/MM/YYYY hh:mm a")),t.xp6(3),t.Oqu(e.client.name),t.xp6(2),t.hij("$",e.taxes,""),t.xp6(2),t.hij("$",e.subtotal,""),t.xp6(2),t.hij("$",e.total,"")}}function x(n,i){if(1&n&&(t.TgZ(0,"table",24),t.TgZ(1,"thead",25),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4,"#"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Estatus"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Fecha"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Cliente"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Impuestos"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Subtotal"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Total"),t.qZA(),t._UZ(17,"th"),t.qZA(),t.qZA(),t.TgZ(18,"tbody"),t.YNc(19,v,16,10,"tr",26),t.qZA(),t.qZA()),2&n){const e=t.oxw(2);t.xp6(19),t.Q6J("ngForOf",e.orders)}}function y(n,i){if(1&n&&(t.TgZ(0,"div",16),t.YNc(1,x,20,1,"table",23),t.qZA()),2&n){const e=t.oxw(),s=t.MAs(43);t.xp6(1),t.Q6J("ngIf",!(null==e.orders||!e.orders.length))("ngIfElse",s)}}function q(n,i){1&n&&(t.TgZ(0,"div",28),t._UZ(1,"i",29),t.qZA())}function b(n,i){1&n&&(t.TgZ(0,"div",30),t._uU(1," No tiene ordenes por cobrar "),t.qZA())}const C=[{path:"",component:(()=>{class n{constructor(e,s,o,l){this.toast=e,this.http=s,this.csv=o,this.nav=l,this.orders=[],this.orderStatuses=[],this.loading={updating:!1,getting:!0}}ngOnInit(){this.GetOrderStatuses(),this.GetOrders()}GoHome(){this.nav.GoToRoleRoute("")}GetOrders(e=null){this.loading.getting=!0;let s="/Orders/OfPayments";e&&(s+=`/FilteredBy/StartDate/${e.startDate}/EndDate/${e.endDate}/Statuses/${JSON.stringify(e.options)}`),this.http.Get(s).subscribe(o=>{this.orders=o,this.loading.getting=!1},o=>{console.error("Error getting Orders",o),this.loading.getting=!1})}GetOrderStatuses(){this.http.Get("/OrderStatuses").subscribe(e=>{this.orderStatuses=e.filter(s=>s.id>=3)},e=>{console.error("Error getting order statuses",e)})}GenerateCsv(){let o=this.orders.map(l=>({}));this.csv.GenerateCSV("cobranza",o,["id","status","date","client","taxes","subtotal","total"],["id","Estatus","Fecha","Cliente","Impuestos","Subtotal","Total"])}GetTotalORdersByStatus(e){let s=0;return this.orders.forEach(o=>{e==o.status.name&&(s+=o.total)}),s}GoToOrder(e){localStorage.setItem("paymentMode",JSON.stringify(!0)),this.nav.GoToRoleRoute("edit-sell-orders/"+e.id)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.k),t.Y36(Z.O),t.Y36(f.M),t.Y36(T.f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payments"]],decls:44,vars:15,consts:[[1,"content"],[1,"d-flex","align-items-center","justify-content-between"],[1,"page-title"],[1,"zmdi","zmdi-home","zmdi-hc-lg","mr-2","clickeable",3,"click"],[1,"d-flex"],["id","csvordersDropdown","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"clickeable","px-2"],[1,"btn","btn-success","mx-1"],[1,"zmdi","zmdi-file","zmdi-hc-lg","mr-2"],["aria-labelledby","csvordersDropdown",1,"dropdown-menu","px-1","py-1"],[1,"menu-list"],[1,"d-flex","align-items-center","px-3","my-1","clickeable-hover",3,"click"],[1,"zmdi","zmdi-download"],[1,"pl-2"],[1,"row","justify-content-center"],[1,"col-12","mb-4"],[3,"timerTrigger","filters","onSearch",4,"ngIf"],[1,"col-12","col-lg-11"],[1,"total-card"],[1,"total"],["class","col-12 col-lg-11",4,"ngIf","ngIfElse"],["bigLoading",""],["noOrdersMessage",""],[3,"timerTrigger","filters","onSearch"],["class","table table-striped",4,"ngIf","ngIfElse"],[1,"table","table-striped"],[1,"table-thead"],[4,"ngFor","ngForOf"],[1,"clickeable",3,"click"],[1,"w-100","h-75","d-flex","align-items-center","justify-content-center",2,"min-height","min-content"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"],[1,"no-items-message"]],template:function(e,s){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"i",3),t.NdJ("click",function(){return s.GoHome()}),t.qZA(),t._uU(4," Cobranza "),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"button",6),t._UZ(8,"i",7),t._uU(9," CSV "),t.qZA(),t.TgZ(10,"div",8),t.TgZ(11,"div",9),t.TgZ(12,"div",10),t.NdJ("click",function(){return s.GenerateCsv()}),t._UZ(13,"i",11),t.TgZ(14,"span",12),t._uU(15,"Exportar ordenes"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"div",13),t.TgZ(17,"div",14),t.YNc(18,_,1,4,"app-filters",15),t.qZA(),t.TgZ(19,"div",16),t.TgZ(20,"div",17),t.TgZ(21,"div",18),t.TgZ(22,"span"),t._uU(23,"Pendientes:"),t.qZA(),t.TgZ(24,"span"),t._uU(25),t.ALo(26,"number"),t.qZA(),t.qZA(),t.TgZ(27,"div",18),t.TgZ(28,"span"),t._uU(29,"Pagadas:"),t.qZA(),t.TgZ(30,"span"),t._uU(31),t.ALo(32,"number"),t.qZA(),t.qZA(),t.TgZ(33,"div",18),t.TgZ(34,"span"),t._uU(35,"Incobrables:"),t.qZA(),t.TgZ(36,"span"),t._uU(37),t.ALo(38,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(39,y,2,2,"div",19),t.qZA(),t.qZA(),t.YNc(40,q,2,0,"ng-template",null,20,t.W1O),t.YNc(42,b,2,0,"ng-template",null,21,t.W1O)),2&e){const o=t.MAs(41);t.xp6(18),t.Q6J("ngIf",!!s.orderStatuses.length),t.xp6(7),t.hij("$",t.xi3(26,6,s.GetTotalORdersByStatus("Pendiente de pago"),"0.2-2"),""),t.xp6(6),t.hij("$",t.xi3(32,9,s.GetTotalORdersByStatus("Pagado"),"0.2-2"),""),t.xp6(6),t.hij("$",t.xi3(38,12,s.GetTotalORdersByStatus("Incobrable"),"0.2-2"),""),t.xp6(2),t.Q6J("ngIf",!s.loading.getting)("ngIfElse",o)}},directives:[a.O5,h.b,a.sg],pipes:[a.JJ,a.uU],styles:[".total-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border:1px solid #ccc;border-radius:12px;margin:1rem 0;padding:1.5rem}.total[_ngcontent-%COMP%]{display:flex;grid-gap:12px;gap:12px;font-size:2rem}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-weight:700}"]}),n})()}];let O=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[c.u5,a.ez,p.F,m.A0,c.UX,g.Bz.forChild(C)]]}),n})()}}]);