"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[35],{6035:(ut,Z,s)=>{s.r(Z),s.d(Z,{ProductsModule:()=>at});var g=s(6019),T=s(850),l=s(7537),u=s(5838),t=s(1514),x=s(822),h=s(9853),A=s(6588),v=s(7754),C=s(1843),q=s(6155),f=s(1435);function y(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t.TgZ(14,"div",29),t.TgZ(15,"i",30),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(3),a=t.MAs(33);return d.EditProduct(c),d.modal.OpenModal(a)}),t.qZA(),t.TgZ(16,"i",31),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(3),a=t.MAs(31);return d.selectedProduct=c,d.modal.OpenModal(a)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=i.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.price),t.xp6(2),t.Oqu(e.tax),t.xp6(2),t.Oqu((null==e.salesMeasurementType?null:e.salesMeasurementType.name)+" - "+(null==e.salesMeasurementType?null:e.salesMeasurementType.abrev)),t.xp6(2),t.Oqu((null==e.inventoryMeasurementType?null:e.inventoryMeasurementType.name)+" - "+(null==e.inventoryMeasurementType?null:e.inventoryMeasurementType.abrev)),t.xp6(2),t.Oqu(null!=e.buyer&&e.buyer.name?null==e.buyer?null:e.buyer.name:"No asignado")}}function P(o,i){if(1&o&&(t.TgZ(0,"div",23),t._UZ(1,"div",24),t.TgZ(2,"div",25),t.TgZ(3,"table",26),t.TgZ(4,"thead",27),t.TgZ(5,"tr"),t.TgZ(6,"th"),t._uU(7,"Nombre"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Precio"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Impuesto"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Unidad de medida (ventas)"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Unidad de medida (inventario)"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Comprador"),t.qZA(),t._UZ(18,"th"),t.qZA(),t.qZA(),t.TgZ(19,"tbody"),t.YNc(20,y,17,6,"tr",28),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(20),t.Q6J("ngForOf",e.products)}}function b(o,i){if(1&o&&(t.ynx(0),t.YNc(1,P,21,1,"div",22),t.BQk()),2&o){const e=t.oxw(),n=t.MAs(27);t.xp6(1),t.Q6J("ngIf",!(null==e.products||!e.products.length))("ngIfElse",n)}}function N(o,i){1&o&&(t.TgZ(0,"div",32),t._UZ(1,"i",33),t.qZA())}function F(o,i){1&o&&(t.TgZ(0,"div",34),t._uU(1," No tiene productos registrados "),t.qZA())}function U(o,i){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.qZA()),2&o){const e=i.$implicit;t.xp6(2),t.Oqu(e.product.name),t.xp6(2),t.Oqu(e.reason?e.reason:"Error al crear")}}function I(o,i){if(1&o&&(t.TgZ(0,"div",48),t.TgZ(1,"div",49),t._uU(2," Error al crear productos "),t.qZA(),t.TgZ(3,"table",50),t.TgZ(4,"thead",51),t.TgZ(5,"tr"),t.TgZ(6,"th"),t._uU(7,"Nombre"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Motivo"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"tbody"),t.YNc(11,U,5,2,"tr",28),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(11),t.Q6J("ngForOf",e.productsFailed)}}function w(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"Cancelar"),t.qZA())}function M(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"Cerrar"),t.qZA())}function k(o,i){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.csvAcceptLabel)}}function J(o,i){1&o&&(t.TgZ(0,"span"),t._UZ(1,"i",52),t.qZA())}function z(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",35),t.TgZ(1,"h2",36),t._uU(2,"Agregar por CSV"),t.qZA(),t.TgZ(3,"i",37),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(r.loading.updating)}),t.qZA(),t.qZA(),t.TgZ(4,"div",38),t.TgZ(5,"div",39),t.TgZ(6,"div",1),t.TgZ(7,"button",40),t.NdJ("click",function(){return t.CHM(e),t.MAs(12).click()}),t._uU(8," Seleccionar archivo "),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA(),t.TgZ(11,"input",41,42),t.NdJ("change",function(r){return t.CHM(e),t.oxw().OnFileSelected(r)}),t.qZA(),t.qZA(),t.YNc(13,I,12,1,"div",43),t.qZA(),t.qZA(),t.TgZ(14,"div",44),t.TgZ(15,"button",45),t.NdJ("click",function(){return t.CHM(e),t.oxw().modal.CloseModal()}),t.YNc(16,w,2,0,"span",46),t.YNc(17,M,2,0,"span",46),t.qZA(),t.TgZ(18,"button",47),t.NdJ("click",function(){return t.CHM(e),t.oxw().RegisterProducts()}),t.YNc(19,k,2,1,"span",46),t.YNc(20,J,2,0,"span",46),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(10),t.hij(" ",null==e.productsCsv?null:e.productsCsv.name," "),t.xp6(3),t.Q6J("ngIf",!(null==e.productsFailed||!e.productsFailed.length)),t.xp6(3),t.Q6J("ngIf",!(null!=e.productsFailed&&e.productsFailed.length)),t.xp6(1),t.Q6J("ngIf",!(null==e.productsFailed||!e.productsFailed.length)),t.xp6(1),t.Q6J("disabled",e.loading.updating),t.xp6(1),t.Q6J("ngIf",!e.loading.updating),t.xp6(1),t.Q6J("ngIf",e.loading.updating)}}function G(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"Si, eliminar"),t.qZA())}function Y(o,i){1&o&&(t.TgZ(0,"span"),t._UZ(1,"i",52),t.qZA())}function Q(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",35),t.TgZ(1,"h2",36),t._uU(2,"Eliminar producto"),t.qZA(),t.TgZ(3,"i",37),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(r.loading.updating),r.productForm.reset()}),t.qZA(),t.qZA(),t.TgZ(4,"div",38),t.TgZ(5,"div",4),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",44),t.TgZ(8,"button",53),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(),r.productForm.reset()}),t._uU(9," No, cancelar "),t.qZA(),t.TgZ(10,"button",54),t.NdJ("click",function(){return t.CHM(e),t.oxw().DeleteProduct()}),t.YNc(11,G,2,0,"span",46),t.YNc(12,Y,2,0,"span",46),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.hij(' \xbfEsta seguro que desea eliminar a "',null==e.selectedProduct?null:e.selectedProduct.name,'"? '),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(1),t.Q6J("ngIf",!e.loading.updating),t.xp6(1),t.Q6J("ngIf",e.loading.updating)}}function E(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function S(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,E,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"name"))?null:n.errors.required)}}function B(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function O(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Solo n\xfameros enteros "),t.qZA())}function D(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,B,2,0,"span",77),t.YNc(2,O,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"satCode"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"satCode"))?null:r.errors.onlynumbers)}}function H(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function R(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Solo numeros con un maximo de 2 decimales "),t.qZA())}function K(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,H,2,0,"span",77),t.YNc(2,R,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:r.errors.pricenumber)}}function j(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function W(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Solo numeros con un maximo de 2 decimales "),t.qZA())}function L(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,j,2,0,"span",77),t.YNc(2,W,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"price"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"price"))?null:r.errors.pricenumber)}}function V(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function $(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Solo n\xfameros enteros "),t.qZA())}function X(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,V,2,0,"span",77),t.YNc(2,$,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"tax"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"tax"))?null:r.errors.onlynumbers)}}function tt(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function et(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,tt,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"salesMeasurementTypeId"))?null:n.errors.required)}}function ot(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function nt(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,ot,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"inventoryMeasurementTypeId"))?null:n.errors.required)}}function rt(o,i){1&o&&(t.TgZ(0,"span",78),t._uU(1," Campo obligatorio "),t.qZA())}function it(o,i){if(1&o&&(t.TgZ(0,"div",76),t.YNc(1,rt,2,0,"span",77),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"buyerId"))?null:n.errors.required)}}function lt(o,i){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.isEditing?"Actualizar":"Agregar")}}function ct(o,i){1&o&&(t.TgZ(0,"span"),t._UZ(1,"i",52),t.qZA())}function dt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",35),t.TgZ(1,"h2",36),t._uU(2),t.qZA(),t.TgZ(3,"i",37),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(r.loading.updating),r.productForm.reset()}),t.qZA(),t.qZA(),t.TgZ(4,"div",38),t.TgZ(5,"div",55),t.TgZ(6,"form",56),t.TgZ(7,"div",57),t.TgZ(8,"div",58),t.TgZ(9,"div",59),t.TgZ(10,"label"),t._uU(11,"Nombre "),t.TgZ(12,"span",60),t._uU(13,"*"),t.qZA(),t.qZA(),t.TgZ(14,"div",61),t._UZ(15,"i",62),t.TgZ(16,"input",63),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(17,S,2,1,"div",64),t.qZA(),t.qZA(),t.TgZ(18,"div",65),t.TgZ(19,"div",59),t.TgZ(20,"label"),t._uU(21,"C\xf3digo del SAT "),t.TgZ(22,"span",60),t._uU(23,"*"),t.qZA(),t.qZA(),t.TgZ(24,"div",61),t._UZ(25,"i",62),t.TgZ(26,"input",66),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(27,D,3,2,"div",64),t.qZA(),t.qZA(),t.TgZ(28,"div",65),t.TgZ(29,"div",59),t.TgZ(30,"label"),t._uU(31,"Peso promedio por pieza "),t.TgZ(32,"span",60),t._uU(33,"*"),t.qZA(),t.qZA(),t.TgZ(34,"div",61),t._UZ(35,"i",62),t.TgZ(36,"input",67),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(37,K,3,2,"div",64),t.qZA(),t.qZA(),t.TgZ(38,"div",65),t.TgZ(39,"div",59),t.TgZ(40,"label"),t._uU(41,"Precio "),t.TgZ(42,"span",60),t._uU(43,"*"),t.qZA(),t.qZA(),t.TgZ(44,"div",61),t._UZ(45,"i",68),t.TgZ(46,"input",69),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(47,L,3,2,"div",64),t.qZA(),t.qZA(),t.TgZ(48,"div",65),t.TgZ(49,"div",59),t.TgZ(50,"label"),t._uU(51,"Impuesto "),t.TgZ(52,"span",60),t._uU(53,"*"),t.qZA(),t.qZA(),t.TgZ(54,"div",61),t._UZ(55,"i",70),t.TgZ(56,"input",71),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(57,X,3,2,"div",64),t.qZA(),t.qZA(),t.TgZ(58,"div",65),t.TgZ(59,"div",59),t.TgZ(60,"label"),t._uU(61,"Unidad de medida para ventas "),t.TgZ(62,"span",60),t._uU(63,"*"),t.qZA(),t.qZA(),t.TgZ(64,"ng-select",72),t.NdJ("change",function(r){return t.CHM(e),t.oxw().OnSalesMeasurementTypeChanges(r)}),t.qZA(),t.YNc(65,et,2,1,"div",64),t.qZA(),t.qZA(),t.TgZ(66,"div",65),t.TgZ(67,"div",59),t.TgZ(68,"label"),t._uU(69,"Unidad de medida para inventario "),t.TgZ(70,"span",60),t._uU(71,"*"),t.qZA(),t.qZA(),t._UZ(72,"ng-select",73),t.YNc(73,nt,2,1,"div",64),t.qZA(),t.qZA(),t.TgZ(74,"div",58),t.TgZ(75,"div",59),t.TgZ(76,"label"),t._uU(77,"Comprador "),t.TgZ(78,"span",60),t._uU(79,"*"),t.qZA(),t.qZA(),t._UZ(80,"ng-select",74),t.YNc(81,it,2,1,"div",64),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(82,"div",44),t.TgZ(83,"button",53),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(),r.productForm.reset()}),t._uU(84," Cancelar "),t.qZA(),t.TgZ(85,"button",75),t.NdJ("click",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.YNc(86,lt,2,1,"span",46),t.YNc(87,ct,2,0,"span",46),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();let n,r,c,d,a,p,m,_;t.xp6(2),t.Oqu(e.isEditing?"Actualizar producto":"Agregar un producto"),t.xp6(4),t.Q6J("formGroup",e.productForm),t.xp6(11),t.Q6J("ngIf",(null==(n=e.form.GetFormControlByName(e.productForm,"name"))?null:n.touched)&&(null==(n=e.form.GetFormControlByName(e.productForm,"name"))?null:n.errors)),t.xp6(10),t.Q6J("ngIf",(null==(r=e.form.GetFormControlByName(e.productForm,"satCode"))?null:r.touched)&&(null==(r=e.form.GetFormControlByName(e.productForm,"satCode"))?null:r.errors)),t.xp6(10),t.Q6J("ngIf",(null==(c=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:c.touched)&&(null==(c=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:c.errors)),t.xp6(10),t.Q6J("ngIf",(null==(d=e.form.GetFormControlByName(e.productForm,"price"))?null:d.touched)&&(null==(d=e.form.GetFormControlByName(e.productForm,"price"))?null:d.errors)),t.xp6(10),t.Q6J("ngIf",(null==(a=e.form.GetFormControlByName(e.productForm,"tax"))?null:a.touched)&&(null==(a=e.form.GetFormControlByName(e.productForm,"tax"))?null:a.errors)),t.xp6(7),t.Q6J("items",e.measurementTypes),t.xp6(1),t.Q6J("ngIf",(null==(p=e.form.GetFormControlByName(e.productForm,"salesMeasurementTypeId"))?null:p.touched)&&(null==(p=e.form.GetFormControlByName(e.productForm,"salesMeasurementTypeId"))?null:p.errors)),t.xp6(7),t.Q6J("items",e.measurementTypes),t.xp6(1),t.Q6J("ngIf",(null==(m=e.form.GetFormControlByName(e.productForm,"inventoryMeasurementTypeId"))?null:m.touched)&&(null==(m=e.form.GetFormControlByName(e.productForm,"inventoryMeasurementTypeId"))?null:m.errors)),t.xp6(7),t.Q6J("items",e.buyers),t.xp6(1),t.Q6J("ngIf",(null==(_=e.form.GetFormControlByName(e.productForm,"buyerId"))?null:_.touched)&&(null==(_=e.form.GetFormControlByName(e.productForm,"buyerId"))?null:_.errors)),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(1),t.Q6J("ngIf",!e.loading.updating),t.xp6(1),t.Q6J("ngIf",e.loading.updating)}}const st=[{path:"",component:(()=>{class o{constructor(e,n,r,c,d,a){this.form=e,this.modal=n,this.toast=r,this.http=c,this.csv=d,this.nav=a,this.measurementTypes=[],this.products=[],this.buyers=[],this.selectedProduct=null,this.isEditing=!1,this.productsToUpload=[],this.productsFailed=[],this.loading={updating:!1,getting:!0},this.productForm=new l.cw({id:new l.NI(null,[]),name:new l.NI("",[l.kI.required]),satCode:new l.NI("",[l.kI.required,(0,u.wp)()]),weightPerPiece:new l.NI("",[l.kI.required,(0,u.AW)()]),price:new l.NI("",[l.kI.required,(0,u.AW)()]),tax:new l.NI("",[l.kI.required,(0,u.wp)()]),buyerId:new l.NI(null,[l.kI.required]),salesMeasurementTypeId:new l.NI(null,[l.kI.required]),inventoryMeasurementTypeId:new l.NI(null,[l.kI.required])}),this.dataConversions=[{oldKey:"Nombre",newKey:"name"},{oldKey:"Codigo SAT",newKey:"satCode"},{oldKey:"Precio",newKey:"price"},{oldKey:"Impuesto",newKey:"tax"},{oldKey:"Unidad de medida ventas",newKey:"salesMeasurementType"},{oldKey:"Unidad de medida inventario",newKey:"inventoryMeasurementType"}]}get csvAcceptLabel(){return this.productsFailed.length?"Reintentar":"Subir"}ngOnInit(){this.GetBuyers(),this.GetMeasurementTypes(),this.GetProducts()}GoHome(){this.nav.GoToRoleRoute("")}OnSalesMeasurementTypeChanges(e){var n,r;e&&!(null===(n=this.productForm.get("inventoryMeasurementTypeId"))||void 0===n?void 0:n.value)&&(null===(r=this.productForm.get("inventoryMeasurementTypeId"))||void 0===r||r.setValue(e.id))}GetMeasurementTypes(){this.http.Get("MeasurementTypes").subscribe(e=>{this.measurementTypes=e},e=>{console.error("Error getting measurement types",e)})}GetBuyers(){this.loading.getting=!0,this.http.Get("Buyers").subscribe(e=>{this.buyers=e,this.loading.getting=!1},e=>{console.error("Error getting buyers",e),this.loading.getting=!1})}GetProducts(){this.loading.getting=!0,this.http.Get("Products").subscribe(e=>{this.products=e,this.loading.getting=!1},e=>{console.error("Error getting products",e),this.loading.getting=!1})}RegisterProduct(){if(this.productForm.invalid)return this.productForm.markAllAsTouched(),void this.toast.ShowDefaultWarning("Favor de llenar los campos obligatorios");this.loading.updating=!0,this.isEditing?this.UpdateProduct():this.http.Post("Products",{product:this.productForm.value}).subscribe(e=>{this.GetProducts(),this.toast.ShowDefaultSuccess("Producto creado exitosamente"),this.productForm.reset(),this.modal.CloseModal(),this.loading.updating=!1},e=>{this.toast.ShowDefaultDanger("Error al crear producto"),console.error("Error creating Product",e),this.loading.updating=!1})}RegisterProducts(){this.loading.updating=!0,this.http.Post("Products/Array",{products:this.productsToUpload}).subscribe(e=>{this.GetProducts(),this.productsFailed=e.productsFailed,e.productsSuccess.length&&this.toast.ShowDefaultSuccess(`${e.productsSuccess.length} productos creados correctamente`),e.productsFailed.length?this.toast.ShowDefaultWarning(`${e.productsFailed.length} productos no se pudieron crear`):(this.modal.CloseModal(),this.productsToUpload=[]),this.loading.updating=!1},e=>{console.error("Error creating Products",e),this.toast.ShowDefaultDanger("Error al crear productos"),this.loading.updating=!1})}UpdateProduct(){this.http.Patch("Products",{product:this.productForm.value}).subscribe(n=>{this.GetProducts(),this.toast.ShowDefaultSuccess("producto actualizado con \xe9xito"),this.modal.CloseModal(),this.isEditing=!1,this.loading.updating=!1},n=>{console.error("Error patching Product",n),this.toast.ShowDefaultDanger("Error al actualizar producto"),this.loading.updating=!1})}EditProduct(e){this.isEditing=!0;for(const n in this.productForm.controls)Object.prototype.hasOwnProperty.call(this.productForm.controls,n)&&this.productForm.controls[n].setValue(e[n])}DeleteProduct(){this.loading.updating=!0,this.http.Delete(`Products/${this.selectedProduct.id}`,{}).subscribe(e=>{this.GetProducts(),this.toast.ShowDefaultSuccess("producto eliminado correctamente"),this.modal.CloseModal(),this.loading.updating=!1},e=>{console.error("Error deleting Product",e),this.toast.ShowDefaultDanger("Error al eliminar producto"),this.loading.updating=!1})}DownloadTemplate(){this.http.DownloadFileWithoutApi("assets/templates/plantilla_productos.csv","plantilla_productos.csv")}OnFileSelected(e){const n=e.target.files[0];if(this.productsCsv=n,!n)return;const r=new FileReader;r.onload=c=>{this.csv.ReadCSV(r.result).then(d=>{this.productsToUpload=this.FormatData(d.data)})},r.readAsText(n,"ISO-8859-3")}FormatData(e){return e.map(n=>{let r={};return this.dataConversions.forEach(c=>{r[c.newKey]=n[c.oldKey]}),r})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.o),t.Y36(h.Z),t.Y36(A.k),t.Y36(v.O),t.Y36(C.M),t.Y36(q.f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-products"]],decls:34,vars:2,consts:[[1,"content"],[1,"d-flex","align-items-center","justify-content-between"],[1,"page-title"],[1,"zmdi","zmdi-home","zmdi-hc-lg","mr-2","clickeable",3,"click"],[1,"d-flex"],[1,"btn","btn-success","mx-1",3,"click"],[1,"zmdi","zmdi-plus-circle-o","zmdi-hc-lg","mr-2"],["id","csvProductsDropdown","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"clickeable","px-2"],[1,"btn","btn-success","mx-1"],[1,"zmdi","zmdi-file","zmdi-hc-lg","mr-2"],["aria-labelledby","csvProductsDropdown",1,"dropdown-menu","px-1","py-1"],[1,"menu-list"],[1,"d-flex","align-items-center","px-3","my-1","clickeable-hover",3,"click"],[1,"zmdi","zmdi-file-text"],[1,"pl-2"],[1,"zmdi","zmdi-file-plus"],[4,"ngIf","ngIfElse"],["bigLoading",""],["noProductsMessage",""],["addProductsByCsvModal",""],["deleteProductModal",""],["addOrEditProductModal",""],["class","row justify-content-center",4,"ngIf","ngIfElse"],[1,"row","justify-content-center"],[1,"col-12","mb-4"],[1,"col-12","col-lg-11"],[1,"table","table-striped"],[1,"table-thead"],[4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","justify-content-center"],[1,"zmdi","zmdi-edit","zmdi-hc-lg","clickeable","mx-2",3,"click"],[1,"zmdi","zmdi-delete","zmdi-hc-lg","clickeable","mx-2",3,"click"],[1,"w-100","h-75","d-flex","align-items-center","justify-content-center",2,"min-height","min-content"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"],[1,"no-items-message"],[1,"modal-header"],[1,"modal-title"],[1,"close-modal-button","zmdi","zmdi-close-circle-o","zmdi-hc-2x","clickeable",3,"click"],[1,"modal-body"],[1,"d-flex","flex-column","justify-content-between"],[1,"btn","btn-outline-primary",3,"click"],["type","file","accept",".csv",1,"d-none",3,"change"],["csvFileInput",""],["class","modal-table",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[4,"ngIf"],[1,"btn","btn-success",3,"disabled","click"],[1,"modal-table"],[1,"my-4","text-center",2,"font-size","1.25rem","font-weight","700"],[1,"table","table-danger","table-striped"],[1,"table-thead","bg-danger"],[1,"zmdi","zmdi-spinner","zmdi-hc-lg","zmdi-hc-spin"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"btn","btn-danger",3,"disabled","click"],[1,"w-100"],[3,"formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],[1,"text-danger"],[1,"input-container"],[1,"input-icon","zmdi","zmdi-collection-text","zmdi-hc-lg"],["type","text","placeholder","Nombre del producto","formControlName","name",1,"form-control",3,"keyup.enter"],["class","error-messages",4,"ngIf"],[1,"col-12","col-sm-6"],["type","text","placeholder","C\xf3dgio del SAT del producto","formControlName","satCode",1,"form-control",3,"keyup.enter"],["type","text","placeholder","Peso promedio en Kg","formControlName","weightPerPiece",1,"form-control",3,"keyup.enter"],[1,"input-icon","zmdi","zmdi-money","zmdi-hc-lg"],["type","text","placeholder","Precio del producto","formControlName","price",1,"form-control",3,"keyup.enter"],[1,"input-icon","zmdi","zmdi-money-box","zmdi-hc-lg"],["type","text","placeholder","Impuesto del producto","formControlName","tax",1,"form-control",3,"keyup.enter"],["bindLabel","name","bindValue","id","placeholder","Unidad de medida (ventas)","formControlName","salesMeasurementTypeId",1,"",3,"items","change"],["bindLabel","name","bindValue","id","placeholder","Unidad de medida (inventario)","formControlName","inventoryMeasurementTypeId",1,"",3,"items"],["bindLabel","name","bindValue","id","placeholder","Comprador","formControlName","buyerId",1,"",3,"items"],[1,"btn","btn-primary",3,"disabled","click"],[1,"error-messages"],["class","d-block",4,"ngIf"],[1,"d-block"]],template:function(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"i",3),t.NdJ("click",function(){return n.GoHome()}),t.qZA(),t._uU(4," Mis productos "),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(33);return n.modal.OpenModal(d)}),t._UZ(7,"i",6),t._uU(8," Agregar "),t.qZA(),t.TgZ(9,"div",7),t.TgZ(10,"button",8),t._UZ(11,"i",9),t._uU(12," CSV "),t.qZA(),t.TgZ(13,"div",10),t.TgZ(14,"div",11),t.TgZ(15,"div",12),t.NdJ("click",function(){return n.DownloadTemplate()}),t._UZ(16,"i",13),t.TgZ(17,"span",14),t._uU(18,"Descargar plantilla"),t.qZA(),t.qZA(),t.TgZ(19,"div",12),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(29);return n.modal.OpenModal(d)}),t._UZ(20,"i",15),t.TgZ(21,"span",14),t._uU(22,"Subir archivo"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(23,b,2,2,"ng-container",16),t.qZA(),t.YNc(24,N,2,0,"ng-template",null,17,t.W1O),t.YNc(26,F,2,0,"ng-template",null,18,t.W1O),t.YNc(28,z,21,7,"ng-template",null,19,t.W1O),t.YNc(30,Q,13,5,"ng-template",null,20,t.W1O),t.YNc(32,dt,88,17,"ng-template",null,21,t.W1O)}if(2&e){const r=t.MAs(25);t.xp6(23),t.Q6J("ngIf",!n.loading.getting)("ngIfElse",r)}},directives:[g.O5,g.sg,l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,f.w9],styles:[""]}),o})()}];let at=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[l.u5,g.ez,f.A0,l.UX,T.Bz.forChild(st)]]}),o})()}}]);