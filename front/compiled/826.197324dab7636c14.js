"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[826],{4826:(N,u,s)=>{s.r(u),s.d(u,{InventoryModule:()=>J});var d=s(6019),y=s(850),c=s(7537),p=s(1435),t=s(1514),h=s(9853),m=s(6588),v=s(7754),f=s(6155),Z=s(1843),_=s(5749),T=s(5838),I=s(822);function C(o,r){1&o&&(t.TgZ(0,"span",18),t._uU(1," Campo obligatorio "),t.qZA())}function A(o,r){1&o&&(t.TgZ(0,"span",18),t._uU(1," Valor invalido "),t.qZA())}function q(o,r){if(1&o&&(t.TgZ(0,"div",16),t.YNc(1,C,2,0,"span",17),t.YNc(2,A,2,0,"span",17),t.qZA()),2&o){const n=t.oxw();let e,i;t.xp6(1),t.Q6J("ngIf",null==(e=n.form.GetFormControlByName(n.productInventoryForm,"quantity"))?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==(i=n.form.GetFormControlByName(n.productInventoryForm,"quantity"))?null:i.errors.onlynumbers)}}function x(o,r){if(1&o){const n=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"button",20),t.NdJ("click",function(){return t.CHM(n),t.oxw().Update()}),t._uU(2," Actualizar "),t.qZA(),t.qZA()}}const b=function(o){return{"caret-active":o}};function H(o,r){if(1&o){const n=t.EpF();t.TgZ(0,"div",21),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return i.showHistory=!i.showHistory}),t._UZ(1,"i",22),t.qZA()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(1,b,n.showHistory))}}function F(o,r){if(1&o&&(t.TgZ(0,"div",23),t.TgZ(1,"div",14),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"div",14),t._uU(5),t.qZA(),t.qZA()),2&o){const n=r.$implicit,e=t.oxw();t.xp6(2),t.Oqu(t.xi3(3,2,n.date,"dd/MM/YYYY")),t.xp6(3),t.Oqu(n.quantity+" "+e.product.inventoryMeasurementType.abrev)}}const P=function(o){return{"toggle-active":o}};let g=(()=>{class o{constructor(n,e,i){this.form=n,this.toast=e,this.http=i,this.product=null,this.history=!1,this.toggleHistory=null,this.onUpdate=new t.vpe,this.showHistory=!1,this.productInventoryForm=new c.cw({id:new c.NI("",[c.kI.required]),quantity:new c.NI("",[c.kI.required,(0,T.wp)()])})}ngOnInit(){this.history&&this.productInventoryForm.disable(),this.toggleHistory&&this.toggleHistory.subscribe(n=>{this.history="boolean"==typeof n?n:!this.history,this.history?this.productInventoryForm.disable():this.productInventoryForm.enable()}),this.productInventoryForm.setValue({id:this.product.inventories[0].id,quantity:this.product.inventories[0].quantity})}Update(){if(this.productInventoryForm.invalid)return void this.toast.ShowDefaultWarning("Los valores no son validos");let n=this.productInventoryForm.value;this.http.Patch(`/Inventories/${n.id}`,{inventory:n}).subscribe(e=>{this.toast.ShowDefaultSuccess("Precios actualizados")},e=>{console.error("Error updating prices",e)})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(I.o),t.Y36(m.k),t.Y36(v.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-product-inventory-history"]],inputs:{product:"product",history:"history",toggleHistory:"toggleHistory"},outputs:{onUpdate:"onUpdate"},decls:34,vars:14,consts:[[1,"card","d-flex","flex-column"],[3,"formGroup"],[1,"d-flex","align-items-center","justify-content-around","flex-wrap"],[1,"name","mx-2"],[1,"form-group","mx-2"],[1,"text-center"],[1,"input-container"],[1,"input-icon","zmdi","zmdi-assignment","zmdi-hc-lg"],["type","text","placeholder","Precio de compra","formControlName","quantity",1,"form-control",3,"keyup.enter"],["class","error-messages",4,"ngIf"],["class","mx-2",4,"ngIf"],["class","clickeable",3,"click",4,"ngIf"],[1,"d-flex","flex-column","price-history","position-relative",3,"ngClass"],[1,"div-table","t-header"],[1,"th"],["class","div-table t-body",4,"ngFor","ngForOf"],[1,"error-messages"],["class","d-block",4,"ngIf"],[1,"d-block"],[1,"mx-2"],[1,"btn","btn-success",3,"click"],[1,"clickeable",3,"click"],[1,"zmdi","zmdi-caret-down","zmdi-hc-3x",3,"ngClass"],[1,"div-table","t-body"]],template:function(n,e){if(1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"label"),t._uU(7," Ultima modificaci\xf3n"),t.qZA(),t.TgZ(8,"div",5),t._uU(9),t.ALo(10,"date"),t.qZA(),t.qZA(),t.TgZ(11,"div",4),t.TgZ(12,"label"),t._uU(13," Inventario"),t.qZA(),t.TgZ(14,"div",6),t._UZ(15,"i",7),t.TgZ(16,"input",8),t.NdJ("keyup.enter",function(){return e.Update()}),t.qZA(),t.qZA(),t.YNc(17,q,3,2,"div",9),t.qZA(),t.TgZ(18,"div",4),t.TgZ(19,"label"),t._uU(20," Unidad de medida"),t.qZA(),t.TgZ(21,"div",5),t._uU(22),t.qZA(),t.qZA(),t.YNc(23,x,3,0,"div",10),t.YNc(24,H,2,3,"div",11),t.qZA(),t.qZA(),t.TgZ(25,"div",12),t.TgZ(26,"div",13),t.TgZ(27,"div",14),t.TgZ(28,"b"),t._uU(29,"Fecha"),t.qZA(),t.qZA(),t.TgZ(30,"div",14),t.TgZ(31,"b"),t._uU(32,"Inventario"),t.qZA(),t.qZA(),t.qZA(),t.YNc(33,F,6,5,"div",15),t.qZA(),t.qZA()),2&n){let i;t.xp6(1),t.Q6J("formGroup",e.productInventoryForm),t.xp6(3),t.Oqu(null==e.product?null:e.product.name),t.xp6(5),t.hij(" ",t.xi3(10,9,e.product.inventories[0].lastModified,"short")," "),t.xp6(8),t.Q6J("ngIf",(null==(i=e.form.GetFormControlByName(e.productInventoryForm,"quantity"))?null:i.touched)&&(null==(i=e.form.GetFormControlByName(e.productInventoryForm,"quantity"))?null:i.errors)),t.xp6(5),t.hij(" ",e.product.inventoryMeasurementType.abrev," "),t.xp6(1),t.Q6J("ngIf",!e.history),t.xp6(1),t.Q6J("ngIf",e.history),t.xp6(1),t.Q6J("ngClass",t.VKq(12,P,e.showHistory)),t.xp6(8),t.Q6J("ngForOf",null==e.product?null:e.product.inventories)}},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,d.O5,d.mk,d.sg],pipes:[d.uU],styles:[".price-history[_ngcontent-%COMP%]{height:0px;overflow-y:hidden;transition:all .3s ease-in-out;position:relative}.form-group[_ngcontent-%COMP%]{margin:0}.toggle-active[_ngcontent-%COMP%]{margin-top:1.8rem;height:250px;overflow-y:auto}.zmdi-caret-down[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.caret-active[_ngcontent-%COMP%]{transform:rotate(180deg)}.name[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600}.div-table[_ngcontent-%COMP%]{display:flex;align-items:center}.t-header[_ngcontent-%COMP%]{border-radius:12px 12px 0 0!important;background-color:#51a351!important;color:#fff;position:sticky;top:0}.t-body[_ngcontent-%COMP%]{border-top:1px solid #dee2e6}div.price-history[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-of-type(odd){background:#F2F2F2}.th[_ngcontent-%COMP%]{height:50px;width:50%;display:flex;align-items:center;justify-content:center}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}"]}),o})();function U(o,r){if(1&o&&(t.TgZ(0,"div",19),t._UZ(1,"app-product-inventory-history",20),t.qZA()),2&o){const n=r.$implicit,e=t.oxw();t.xp6(1),t.Q6J("product",n)("toggleHistory",e.onShowHistory)}}const w=function(){return{text:!0,startDate:!0,endDate:!0,options:null}};let M=(()=>{class o{constructor(n,e,i,l,a){this.modal=n,this.toast=e,this.http=i,this.nav=l,this.csv=a,this.onShowHistory=new t.vpe,this.showingHistory=!1,this.products=[],this.loading={getting:!1}}ngOnInit(){this.GetProducts()}GoHome(){this.nav.GoToRoleRoute("")}GetProducts(n=null){let e="Products/WithInventory";n&&(e+=`/FilteredBy/Text/${n.text}/StartDate/${n.startDate}/EndDate/${n.endDate}`),this.loading.getting=!0,this.http.Get(e).subscribe(i=>{this.products=i,this.loading.getting=!1},i=>{console.error("Error getting products",i),this.loading.getting=!1})}GenerateCsv(){let i=[];this.products.forEach(l=>{i=i.concat(l.inventories.map(a=>({product:l.name,date:a.date,quantity:a.quantity})))}),this.csv.GenerateCSV("inventario",i,["product","date","quantity"],["Producto","Fecha","Inventario"])}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(h.Z),t.Y36(m.k),t.Y36(v.O),t.Y36(f.f),t.Y36(Z.M))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-inventory"]],decls:23,vars:5,consts:[[1,"content"],[1,"d-flex","align-items-center","justify-content-between"],[1,"page-title"],[1,"zmdi","zmdi-home","zmdi-hc-lg","mr-2","clickeable",3,"click"],[1,"d-flex"],[1,"btn","btn-success","mx-1",3,"click"],[1,"zmdi","zmdi-assignment","zmdi-hc-lg","mr-2"],["id","csvBuyersDropdown","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"clickeable","px-2"],[1,"btn","btn-success","mx-1"],[1,"zmdi","zmdi-file","zmdi-hc-lg","mr-2"],["aria-labelledby","csvBuyersDropdown",1,"dropdown-menu","px-1","py-1"],[1,"menu-list"],[1,"d-flex","align-items-center","px-3","my-1","clickeable-hover",3,"click"],[1,"zmdi","zmdi-download"],[1,"pl-2"],[1,"row"],[1,"col-12","mt-3","mb-4"],[3,"timerTrigger","filters","onSearch"],["class","col-12 my-3",4,"ngFor","ngForOf"],[1,"col-12","my-3"],[3,"product","toggleHistory"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"i",3),t.NdJ("click",function(){return e.GoHome()}),t.qZA(),t._uU(4," Inventario "),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.showingHistory=!e.showingHistory,e.onShowHistory.emit(e.showingHistory)}),t._UZ(7,"i",6),t._uU(8),t.qZA(),t.TgZ(9,"div",7),t.TgZ(10,"button",8),t._UZ(11,"i",9),t._uU(12," CSV "),t.qZA(),t.TgZ(13,"div",10),t.TgZ(14,"div",11),t.TgZ(15,"div",12),t.NdJ("click",function(){return e.GenerateCsv()}),t._UZ(16,"i",13),t.TgZ(17,"span",14),t._uU(18,"Exportar archivo"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",15),t.TgZ(20,"div",16),t.TgZ(21,"app-filters",17),t.NdJ("onSearch",function(l){return e.GetProducts(l)}),t.qZA(),t.qZA(),t.YNc(22,U,2,2,"div",18),t.qZA(),t.qZA()),2&n&&(t.xp6(8),t.hij(" ",e.showingHistory?"Actualizar inventario":"Ver historial"," "),t.xp6(13),t.Q6J("timerTrigger",!0)("filters",t.DdM(4,w)),t.xp6(1),t.Q6J("ngForOf",e.products))},directives:[_.b,d.sg,g],styles:[""]}),o})();var k=s(3550);let z=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[c.u5,d.ez,p.A0,c.UX]]}),o})();const O=[{path:"",component:M}];let J=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[c.u5,d.ez,k.F,p.A0,c.UX,z,y.Bz.forChild(O)]]}),o})()}}]);