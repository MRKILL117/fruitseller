"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[35],{6035:(qt,x,s)=>{s.r(x),s.d(x,{ProductsModule:()=>At});var p=s(6019),v=s(850),a=s(7537),u=s(5838),t=s(1514),y=s(822),C=s(9853),A=s(6588),q=s(7754),P=s(1843),b=s(6155),N=s(5749),h=s(1435);function F(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"number"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t.TgZ(15,"div",31),t.TgZ(16,"i",32),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(3),d=t.MAs(37);return c.EditProduct(l),c.modal.OpenModal(d)}),t.qZA(),t.TgZ(17,"i",33),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(3),d=t.MAs(35);return c.selectedProduct=l,c.modal.OpenModal(d)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=i.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.hij("$",t.xi3(5,6,e.price,"0.2-2"),""),t.xp6(3),t.Oqu(null!=e.type&&e.type.name?null==e.type?null:e.type.name:"Sin tipo"),t.xp6(2),t.Oqu((null==e.salesMeasurementType?null:e.salesMeasurementType.name)+" - "+(null==e.salesMeasurementType?null:e.salesMeasurementType.abrev)),t.xp6(2),t.Oqu((null==e.inventoryMeasurementType?null:e.inventoryMeasurementType.name)+" - "+(null==e.inventoryMeasurementType?null:e.inventoryMeasurementType.abrev)),t.xp6(2),t.Oqu(null!=e.buyer&&e.buyer.name?null==e.buyer?null:e.buyer.name:"No asignado")}}function I(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",24),t.TgZ(1,"div",25),t.TgZ(2,"app-filters",26),t.NdJ("onSearch",function(r){return t.CHM(e),t.oxw(2).GetProducts(r)}),t.qZA(),t.qZA(),t.TgZ(3,"div",27),t.TgZ(4,"table",28),t.TgZ(5,"thead",29),t.TgZ(6,"tr"),t.TgZ(7,"th"),t._uU(8,"Nombre"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Precio"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Tipo"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Unidad de medida (ventas)"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Unidad de medida (inventario)"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Comprador"),t.qZA(),t._UZ(19,"th"),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,F,18,9,"tr",30),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("timerTrigger",!0)("filters",e.filters),t.xp6(19),t.Q6J("ngForOf",e.products)}}function U(o,i){if(1&o&&(t.ynx(0),t.YNc(1,I,22,3,"div",23),t.BQk()),2&o){const e=t.oxw(),n=t.MAs(31);t.xp6(1),t.Q6J("ngIf",!(null==e.products||!e.products.length))("ngIfElse",n)}}function w(o,i){1&o&&(t.TgZ(0,"div",34),t._UZ(1,"i",35),t.qZA())}function M(o,i){1&o&&(t.TgZ(0,"div",36),t._uU(1," No tiene productos registrados "),t.qZA())}function J(o,i){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.qZA()),2&o){const e=i.$implicit;t.xp6(2),t.Oqu(e.product.name),t.xp6(2),t.Oqu(e.reason?e.reason:"Error al crear")}}function k(o,i){if(1&o&&(t.TgZ(0,"div",50),t.TgZ(1,"div",51),t._uU(2," Error al crear productos "),t.qZA(),t.TgZ(3,"table",52),t.TgZ(4,"thead",53),t.TgZ(5,"tr"),t.TgZ(6,"th"),t._uU(7,"Nombre"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Motivo"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"tbody"),t.YNc(11,J,5,2,"tr",30),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(11),t.Q6J("ngForOf",e.productsFailed)}}function G(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"Cancelar"),t.qZA())}function z(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"Cerrar"),t.qZA())}function Q(o,i){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.csvAcceptLabel)}}function Y(o,i){1&o&&(t.TgZ(0,"span"),t._UZ(1,"i",54),t.qZA())}function B(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",37),t.TgZ(1,"h2",38),t._uU(2,"Agregar por CSV"),t.qZA(),t.TgZ(3,"i",39),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(r.loading.updating)}),t.qZA(),t.qZA(),t.TgZ(4,"div",40),t.TgZ(5,"div",41),t.TgZ(6,"div",1),t.TgZ(7,"button",42),t.NdJ("click",function(){return t.CHM(e),t.MAs(12).click()}),t._uU(8," Seleccionar archivo "),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA(),t.TgZ(11,"input",43,44),t.NdJ("change",function(r){return t.CHM(e),t.oxw().OnFileSelected(r)}),t.qZA(),t.qZA(),t.YNc(13,k,12,1,"div",45),t.qZA(),t.qZA(),t.TgZ(14,"div",46),t.TgZ(15,"button",47),t.NdJ("click",function(){return t.CHM(e),t.oxw().modal.CloseModal()}),t.YNc(16,G,2,0,"span",48),t.YNc(17,z,2,0,"span",48),t.qZA(),t.TgZ(18,"button",49),t.NdJ("click",function(){return t.CHM(e),t.oxw().RegisterProducts()}),t.YNc(19,Q,2,1,"span",48),t.YNc(20,Y,2,0,"span",48),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(10),t.hij(" ",null==e.productsCsv?null:e.productsCsv.name," "),t.xp6(3),t.Q6J("ngIf",!(null==e.productsFailed||!e.productsFailed.length)),t.xp6(3),t.Q6J("ngIf",!(null!=e.productsFailed&&e.productsFailed.length)),t.xp6(1),t.Q6J("ngIf",!(null==e.productsFailed||!e.productsFailed.length)),t.xp6(1),t.Q6J("disabled",e.loading.updating),t.xp6(1),t.Q6J("ngIf",!e.loading.updating),t.xp6(1),t.Q6J("ngIf",e.loading.updating)}}function E(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"Si, eliminar"),t.qZA())}function S(o,i){1&o&&(t.TgZ(0,"span"),t._UZ(1,"i",54),t.qZA())}function O(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",37),t.TgZ(1,"h2",38),t._uU(2,"Eliminar producto"),t.qZA(),t.TgZ(3,"i",39),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(r.loading.updating),r.productForm.reset()}),t.qZA(),t.qZA(),t.TgZ(4,"div",40),t.TgZ(5,"div",4),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",46),t.TgZ(8,"button",55),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.modal.CloseModal(),r.productForm.reset()}),t._uU(9," No, cancelar "),t.qZA(),t.TgZ(10,"button",56),t.NdJ("click",function(){return t.CHM(e),t.oxw().DeleteProduct()}),t.YNc(11,E,2,0,"span",48),t.YNc(12,S,2,0,"span",48),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.hij(' \xbfEsta seguro que desea eliminar a "',null==e.selectedProduct?null:e.selectedProduct.name,'"? '),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(1),t.Q6J("ngIf",!e.loading.updating),t.xp6(1),t.Q6J("ngIf",e.loading.updating)}}function D(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function H(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,D,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"name"))?null:n.errors.required)}}function K(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function R(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,K,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"productTypeId"))?null:n.errors.required)}}function j(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function L(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,j,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"buyerId"))?null:n.errors.required)}}function V(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function W(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Solo n\xfameros enteros "),t.qZA())}function $(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,V,2,0,"span",82),t.YNc(2,W,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"satCode"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"satCode"))?null:r.errors.onlynumbers)}}function X(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function tt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Solo n\xfameros con un maximo de 2 decimales "),t.qZA())}function et(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,X,2,0,"span",82),t.YNc(2,tt,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:r.errors.pricenumber)}}function ot(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function nt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Solo n\xfameros con un maximo de 2 decimales "),t.qZA())}function rt(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,ot,2,0,"span",82),t.YNc(2,nt,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"price"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"price"))?null:r.errors.pricenumber)}}function it(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function lt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Solo n\xfameros enteros "),t.qZA())}function at(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,it,2,0,"span",82),t.YNc(2,lt,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"tax"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"tax"))?null:r.errors.onlynumbers)}}function ct(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function st(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,ct,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"salesMeasurementTypeId"))?null:n.errors.required)}}function dt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function ut(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,dt,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"inventoryMeasurementTypeId"))?null:n.errors.required)}}function pt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function mt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Solo n\xfameros enteros "),t.qZA())}function _t(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,pt,2,0,"span",82),t.YNc(2,mt,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"minimumInventory"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"minimumInventory"))?null:r.errors.onlynumbers)}}function gt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Campo obligatorio "),t.qZA())}function Zt(o,i){1&o&&(t.TgZ(0,"span",83),t._uU(1," Solo n\xfameros enteros "),t.qZA())}function Tt(o,i){if(1&o&&(t.TgZ(0,"div",81),t.YNc(1,gt,2,0,"span",82),t.YNc(2,Zt,2,0,"span",82),t.qZA()),2&o){const e=t.oxw(2);let n,r;t.xp6(1),t.Q6J("ngIf",null==(n=e.form.GetFormControlByName(e.productForm,"maximumInventory"))?null:n.errors.required),t.xp6(1),t.Q6J("ngIf",null==(r=e.form.GetFormControlByName(e.productForm,"maximumInventory"))?null:r.errors.onlynumbers)}}function ft(o,i){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Oqu(e.isEditing?"Actualizar":"Agregar")}}function xt(o,i){1&o&&(t.TgZ(0,"span"),t._UZ(1,"i",54),t.qZA())}function ht(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",37),t.TgZ(1,"h2",38),t._uU(2),t.qZA(),t.TgZ(3,"i",39),t.NdJ("click",function(){return t.CHM(e),t.oxw().CancelEdition()}),t.qZA(),t.qZA(),t.TgZ(4,"div",40),t.TgZ(5,"div",57),t.TgZ(6,"form",58),t.TgZ(7,"div",59),t.TgZ(8,"div",60),t.TgZ(9,"div",61),t.TgZ(10,"label"),t._uU(11,"Nombre "),t.TgZ(12,"span",62),t._uU(13,"*"),t.qZA(),t.qZA(),t.TgZ(14,"div",63),t._UZ(15,"i",64),t.TgZ(16,"input",65),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(17,H,2,1,"div",66),t.qZA(),t.qZA(),t.TgZ(18,"div",67),t.TgZ(19,"div",61),t.TgZ(20,"label"),t._uU(21,"Tipo de producto "),t.TgZ(22,"span",62),t._uU(23,"*"),t.qZA(),t.qZA(),t._UZ(24,"ng-select",68),t.YNc(25,R,2,1,"div",66),t.qZA(),t.qZA(),t.TgZ(26,"div",67),t.TgZ(27,"div",61),t.TgZ(28,"label"),t._uU(29,"Comprador "),t.TgZ(30,"span",62),t._uU(31,"*"),t.qZA(),t.qZA(),t._UZ(32,"ng-select",69),t.YNc(33,L,2,1,"div",66),t.qZA(),t.qZA(),t.TgZ(34,"div",67),t.TgZ(35,"div",61),t.TgZ(36,"label"),t._uU(37,"C\xf3digo del SAT "),t.TgZ(38,"span",62),t._uU(39,"*"),t.qZA(),t.qZA(),t.TgZ(40,"div",63),t._UZ(41,"i",64),t.TgZ(42,"input",70),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(43,$,3,2,"div",66),t.qZA(),t.qZA(),t.TgZ(44,"div",67),t.TgZ(45,"div",61),t.TgZ(46,"label"),t._uU(47,"Peso promedio por pieza "),t.TgZ(48,"span",62),t._uU(49,"*"),t.qZA(),t.qZA(),t.TgZ(50,"div",63),t._UZ(51,"i",64),t.TgZ(52,"input",71),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(53,et,3,2,"div",66),t.qZA(),t.qZA(),t.TgZ(54,"div",67),t.TgZ(55,"div",61),t.TgZ(56,"label"),t._uU(57,"Precio "),t.TgZ(58,"span",62),t._uU(59,"*"),t.qZA(),t.qZA(),t.TgZ(60,"div",63),t._UZ(61,"i",72),t.TgZ(62,"input",73),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(63,rt,3,2,"div",66),t.qZA(),t.qZA(),t.TgZ(64,"div",67),t.TgZ(65,"div",61),t.TgZ(66,"label"),t._uU(67,"Impuesto "),t.TgZ(68,"span",62),t._uU(69,"*"),t.qZA(),t.qZA(),t.TgZ(70,"div",63),t._UZ(71,"i",74),t.TgZ(72,"input",75),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(73,at,3,2,"div",66),t.qZA(),t.qZA(),t.TgZ(74,"div",67),t.TgZ(75,"div",61),t.TgZ(76,"label"),t._uU(77,"Unidad de medida para ventas "),t.TgZ(78,"span",62),t._uU(79,"*"),t.qZA(),t.qZA(),t.TgZ(80,"ng-select",76),t.NdJ("change",function(r){return t.CHM(e),t.oxw().OnSalesMeasurementTypeChanges(r)}),t.qZA(),t.YNc(81,st,2,1,"div",66),t.qZA(),t.qZA(),t.TgZ(82,"div",67),t.TgZ(83,"div",61),t.TgZ(84,"label"),t._uU(85,"Unidad de medida para inventario "),t.TgZ(86,"span",62),t._uU(87,"*"),t.qZA(),t.qZA(),t._UZ(88,"ng-select",77),t.YNc(89,ut,2,1,"div",66),t.qZA(),t.qZA(),t.TgZ(90,"div",67),t.TgZ(91,"div",61),t.TgZ(92,"label"),t._uU(93,"Inventario minimo "),t.TgZ(94,"span",62),t._uU(95,"*"),t.qZA(),t.qZA(),t.TgZ(96,"div",63),t._UZ(97,"i",72),t.TgZ(98,"input",78),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(99,_t,3,2,"div",66),t.qZA(),t.qZA(),t.TgZ(100,"div",67),t.TgZ(101,"div",61),t.TgZ(102,"label"),t._uU(103,"Inventario max\xedmo "),t.TgZ(104,"span",62),t._uU(105,"*"),t.qZA(),t.qZA(),t.TgZ(106,"div",63),t._UZ(107,"i",72),t.TgZ(108,"input",79),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.qZA(),t.qZA(),t.YNc(109,Tt,3,2,"div",66),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(110,"div",46),t.TgZ(111,"button",55),t.NdJ("click",function(){return t.CHM(e),t.oxw().CancelEdition()}),t._uU(112," Cancelar "),t.qZA(),t.TgZ(113,"button",80),t.NdJ("click",function(){return t.CHM(e),t.oxw().RegisterProduct()}),t.YNc(114,ft,2,1,"span",48),t.YNc(115,xt,2,0,"span",48),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();let n,r,l,c,d,m,_,g,Z,T,f;t.xp6(2),t.Oqu(e.isEditing?"Actualizar producto":"Agregar un producto"),t.xp6(4),t.Q6J("formGroup",e.productForm),t.xp6(11),t.Q6J("ngIf",(null==(n=e.form.GetFormControlByName(e.productForm,"name"))?null:n.touched)&&(null==(n=e.form.GetFormControlByName(e.productForm,"name"))?null:n.errors)),t.xp6(7),t.Q6J("items",e.productTypes),t.xp6(1),t.Q6J("ngIf",(null==(r=e.form.GetFormControlByName(e.productForm,"productTypeId"))?null:r.touched)&&(null==(r=e.form.GetFormControlByName(e.productForm,"productTypeId"))?null:r.errors)),t.xp6(7),t.Q6J("items",e.buyers),t.xp6(1),t.Q6J("ngIf",(null==(l=e.form.GetFormControlByName(e.productForm,"buyerId"))?null:l.touched)&&(null==(l=e.form.GetFormControlByName(e.productForm,"buyerId"))?null:l.errors)),t.xp6(10),t.Q6J("ngIf",(null==(c=e.form.GetFormControlByName(e.productForm,"satCode"))?null:c.touched)&&(null==(c=e.form.GetFormControlByName(e.productForm,"satCode"))?null:c.errors)),t.xp6(10),t.Q6J("ngIf",(null==(d=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:d.touched)&&(null==(d=e.form.GetFormControlByName(e.productForm,"weightPerPiece"))?null:d.errors)),t.xp6(10),t.Q6J("ngIf",(null==(m=e.form.GetFormControlByName(e.productForm,"price"))?null:m.touched)&&(null==(m=e.form.GetFormControlByName(e.productForm,"price"))?null:m.errors)),t.xp6(10),t.Q6J("ngIf",(null==(_=e.form.GetFormControlByName(e.productForm,"tax"))?null:_.touched)&&(null==(_=e.form.GetFormControlByName(e.productForm,"tax"))?null:_.errors)),t.xp6(7),t.Q6J("items",e.measurementTypes),t.xp6(1),t.Q6J("ngIf",(null==(g=e.form.GetFormControlByName(e.productForm,"salesMeasurementTypeId"))?null:g.touched)&&(null==(g=e.form.GetFormControlByName(e.productForm,"salesMeasurementTypeId"))?null:g.errors)),t.xp6(7),t.Q6J("items",e.measurementTypes),t.xp6(1),t.Q6J("ngIf",(null==(Z=e.form.GetFormControlByName(e.productForm,"inventoryMeasurementTypeId"))?null:Z.touched)&&(null==(Z=e.form.GetFormControlByName(e.productForm,"inventoryMeasurementTypeId"))?null:Z.errors)),t.xp6(10),t.Q6J("ngIf",(null==(T=e.form.GetFormControlByName(e.productForm,"minimumInventory"))?null:T.touched)&&(null==(T=e.form.GetFormControlByName(e.productForm,"minimumInventory"))?null:T.errors)),t.xp6(10),t.Q6J("ngIf",(null==(f=e.form.GetFormControlByName(e.productForm,"maximumInventory"))?null:f.touched)&&(null==(f=e.form.GetFormControlByName(e.productForm,"maximumInventory"))?null:f.errors)),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(2),t.Q6J("disabled",e.loading.updating),t.xp6(1),t.Q6J("ngIf",!e.loading.updating),t.xp6(1),t.Q6J("ngIf",e.loading.updating)}}let vt=(()=>{class o{constructor(e,n,r,l,c,d){this.form=e,this.modal=n,this.toast=r,this.http=l,this.csv=c,this.nav=d,this.measurementTypes=[],this.products=[],this.productTypes=[],this.buyers=[],this.selectedProduct=null,this.isEditing=!1,this.productsToUpload=[],this.productsFailed=[],this.filters=[],this.loading={updating:!1,getting:!0},this.productForm=new a.cw({id:new a.NI(null,[]),name:new a.NI("",[a.kI.required]),satCode:new a.NI("",[a.kI.required,(0,u.wp)()]),weightPerPiece:new a.NI("",[a.kI.required,(0,u.AW)()]),price:new a.NI("",[a.kI.required,(0,u.AW)()]),tax:new a.NI("",[a.kI.required,(0,u.wp)()]),minimumInventory:new a.NI("",[a.kI.required,(0,u.wp)()]),maximumInventory:new a.NI("",[a.kI.required,(0,u.wp)()]),buyerId:new a.NI(null,[a.kI.required]),salesMeasurementTypeId:new a.NI(null,[a.kI.required]),inventoryMeasurementTypeId:new a.NI(null,[a.kI.required]),productTypeId:new a.NI(null,[a.kI.required])}),this.dataConversions=[{oldKey:"Nombre",newKey:"name"},{oldKey:"Codigo SAT",newKey:"satCode"},{oldKey:"Peso promedio por pieza",newKey:"weightPerPiece"},{oldKey:"Precio",newKey:"price"},{oldKey:"Impuesto",newKey:"tax"},{oldKey:"Unidad de medida ventas",newKey:"salesMeasurementType"},{oldKey:"Unidad de medida inventario",newKey:"inventoryMeasurementType"},{oldKey:"Comprador",newKey:"buyer"}]}get csvAcceptLabel(){return this.productsFailed.length?"Reintentar":"Subir"}ngOnInit(){this.InitializeFilters(),this.GetBuyers(),this.GetMeasurementTypes(),this.GetProducts(),this.GetProductTypes()}GoHome(){this.nav.GoToRoleRoute("")}InitializeFilters(){this.filters.push({type:"text",name:"text",placeholder:"Buscar"})}OnSalesMeasurementTypeChanges(e){var n,r;e&&!(null===(n=this.productForm.get("inventoryMeasurementTypeId"))||void 0===n?void 0:n.value)&&(null===(r=this.productForm.get("inventoryMeasurementTypeId"))||void 0===r||r.setValue(e.id))}GetMeasurementTypes(){this.http.Get("MeasurementTypes").subscribe(e=>{this.measurementTypes=e},e=>{console.error("Error getting measurement types",e)})}GetBuyers(){this.loading.getting=!0,this.http.Get("Buyers").subscribe(e=>{this.buyers=e,this.loading.getting=!1},e=>{console.error("Error getting buyers",e),this.loading.getting=!1})}GetProductTypes(){this.loading.getting=!0,this.http.Get("ProductTypes").subscribe(e=>{this.productTypes=e,this.loading.getting=!1},e=>{console.error("Error getting productTypes",e),this.loading.getting=!1})}GetProducts(e=null){this.loading.getting=!0;let n="/Products";e&&(n+=`/FilteredBy/Text/${e.text}`),this.http.Get(n).subscribe(r=>{this.products=r,this.loading.getting=!1},r=>{console.error("Error getting products",r),this.loading.getting=!1})}RegisterProduct(){if(this.productForm.invalid)return this.productForm.markAllAsTouched(),void this.toast.ShowDefaultWarning("Favor de llenar los campos obligatorios");this.loading.updating=!0,this.isEditing?this.UpdateProduct():this.http.Post("Products",{product:this.productForm.value}).subscribe(e=>{this.GetProducts(),this.toast.ShowDefaultSuccess("Producto creado exitosamente"),this.productForm.reset(),this.modal.CloseModal(),this.loading.updating=!1},e=>{this.toast.ShowDefaultDanger("Error al crear producto"),console.error("Error creating Product",e),this.loading.updating=!1})}RegisterProducts(){this.loading.updating=!0,this.http.Post("Products/Array",{products:this.productsToUpload}).subscribe(e=>{this.GetProducts(),this.productsFailed=e.productsFailed,e.productsSuccess.length&&this.toast.ShowDefaultSuccess(`${e.productsSuccess.length} productos creados correctamente`),e.productsFailed.length?this.toast.ShowDefaultWarning(`${e.productsFailed.length} productos no se pudieron crear`):(this.modal.CloseModal(),this.productsToUpload=[]),this.loading.updating=!1},e=>{console.error("Error creating Products",e),this.toast.ShowDefaultDanger("Error al crear productos"),this.loading.updating=!1})}UpdateProduct(){this.http.Patch("Products",{product:this.productForm.value}).subscribe(n=>{this.GetProducts(),this.toast.ShowDefaultSuccess("producto actualizado con \xe9xito"),this.modal.CloseModal(),this.isEditing=!1,this.loading.updating=!1},n=>{console.error("Error patching Product",n),this.toast.ShowDefaultDanger("Error al actualizar producto"),this.loading.updating=!1})}CancelEdition(){this.modal.CloseModal(this.loading.updating),this.isEditing=!1,this.productForm.reset()}EditProduct(e){this.isEditing=!0;for(const n in this.productForm.controls)Object.prototype.hasOwnProperty.call(this.productForm.controls,n)&&this.productForm.controls[n].setValue(e[n])}DeleteProduct(){this.loading.updating=!0,this.http.Delete(`Products/${this.selectedProduct.id}`,{}).subscribe(e=>{this.GetProducts(),this.toast.ShowDefaultSuccess("producto eliminado correctamente"),this.modal.CloseModal(),this.loading.updating=!1},e=>{console.error("Error deleting Product",e),this.toast.ShowDefaultDanger("Error al eliminar producto"),this.loading.updating=!1})}DownloadTemplate(){this.http.DownloadFileWithoutApi("assets/templates/plantilla_productos.csv","plantilla_productos.csv")}OnFileSelected(e){const n=e.target.files[0];if(this.productsCsv=n,!n)return;const r=new FileReader;r.onload=l=>{this.csv.ReadCSV(r.result).then(c=>{this.productsToUpload=this.FormatData(c.data)})},r.readAsText(n,"ISO-8859-3")}FormatData(e){return e.map(n=>{let r={};return this.dataConversions.forEach(l=>{r[l.newKey]=n[l.oldKey]}),r})}GenerateCsv(){let r=this.products.map(l=>({name:l.name,satCode:l.satCode,weightPerPiece:`${l.weightPerPiece} kg`,price:l.price,tax:l.tax,salesMeasurementType:l.salesMeasurementType?l.salesMeasurementType.abrev:"No asignado",inventoryMeasurementType:l.inventoryMeasurementType?l.inventoryMeasurementType.abrev:"No asignado",buyer:l.buyer?l.buyer.name:"No asignado"}));this.csv.GenerateCSV("productos",r,["name","satCode","weightPerPiece","price","tax","salesMeasurementType","inventoryMeasurementType","buyer"],["Nombre","C\xf3digo SAT","Peso promedio por pieza","Precio","Impuesto","Unidad de medida para ventas","Unidad de medida para inventario","Comprador"])}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(y.o),t.Y36(C.Z),t.Y36(A.k),t.Y36(q.O),t.Y36(P.M),t.Y36(b.f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-products"]],decls:38,vars:2,consts:[[1,"content"],[1,"d-flex","align-items-center","justify-content-between"],[1,"page-title"],[1,"zmdi","zmdi-home","zmdi-hc-lg","mr-2","clickeable",3,"click"],[1,"d-flex"],[1,"btn","btn-success","mx-1",3,"click"],[1,"zmdi","zmdi-plus-circle-o","zmdi-hc-lg","mr-2"],["id","csvProductsDropdown","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"clickeable","px-2"],[1,"btn","btn-success","mx-1"],[1,"zmdi","zmdi-file","zmdi-hc-lg","mr-2"],["aria-labelledby","csvProductsDropdown",1,"dropdown-menu","px-1","py-1"],[1,"menu-list"],[1,"d-flex","align-items-center","px-3","my-1","clickeable-hover",3,"click"],[1,"zmdi","zmdi-file-text"],[1,"pl-2"],[1,"zmdi","zmdi-file-plus"],[1,"zmdi","zmdi-download"],[4,"ngIf","ngIfElse"],["bigLoading",""],["noProductsMessage",""],["addProductsByCsvModal",""],["deleteProductModal",""],["addOrEditProductModal",""],["class","row justify-content-center",4,"ngIf","ngIfElse"],[1,"row","justify-content-center"],[1,"col-12","mb-4"],[3,"timerTrigger","filters","onSearch"],[1,"col-12","col-lg-11"],[1,"table","table-striped"],[1,"table-thead"],[4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","justify-content-center"],[1,"zmdi","zmdi-edit","zmdi-hc-lg","clickeable","mx-2",3,"click"],[1,"zmdi","zmdi-delete","zmdi-hc-lg","clickeable","mx-2",3,"click"],[1,"w-100","h-75","d-flex","align-items-center","justify-content-center",2,"min-height","min-content"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"],[1,"no-items-message"],[1,"modal-header"],[1,"modal-title"],[1,"close-modal-button","zmdi","zmdi-close-circle-o","zmdi-hc-2x","clickeable",3,"click"],[1,"modal-body"],[1,"d-flex","flex-column","justify-content-between"],[1,"btn","btn-outline-primary",3,"click"],["type","file","accept",".csv",1,"d-none",3,"change"],["csvFileInput",""],["class","modal-table",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[4,"ngIf"],[1,"btn","btn-success",3,"disabled","click"],[1,"modal-table"],[1,"my-4","text-center",2,"font-size","1.25rem","font-weight","700"],[1,"table","table-danger","table-striped"],[1,"table-thead","bg-danger"],[1,"zmdi","zmdi-spinner","zmdi-hc-lg","zmdi-hc-spin"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"btn","btn-danger",3,"disabled","click"],[1,"w-100"],[3,"formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],[1,"text-danger"],[1,"input-container"],[1,"input-icon","zmdi","zmdi-collection-text","zmdi-hc-lg"],["type","text","placeholder","Nombre del producto","formControlName","name",1,"form-control",3,"keyup.enter"],["class","error-messages",4,"ngIf"],[1,"col-12","col-sm-6"],["bindLabel","name","bindValue","id","placeholder","Tipo","formControlName","productTypeId",1,"",3,"items"],["bindLabel","name","bindValue","id","placeholder","Comprador","formControlName","buyerId",1,"",3,"items"],["type","text","placeholder","C\xf3dgio del SAT del producto","formControlName","satCode",1,"form-control",3,"keyup.enter"],["type","text","placeholder","Peso promedio en Kg","formControlName","weightPerPiece",1,"form-control",3,"keyup.enter"],[1,"input-icon","zmdi","zmdi-money","zmdi-hc-lg"],["type","text","placeholder","Precio del producto","formControlName","price",1,"form-control",3,"keyup.enter"],[1,"input-icon","zmdi","zmdi-money-box","zmdi-hc-lg"],["type","text","placeholder","Impuesto del producto","formControlName","tax",1,"form-control",3,"keyup.enter"],["bindLabel","name","bindValue","id","placeholder","Unidad de medida (ventas)","formControlName","salesMeasurementTypeId",1,"",3,"items","change"],["bindLabel","name","bindValue","id","placeholder","Unidad de medida (inventario)","formControlName","inventoryMeasurementTypeId",1,"",3,"items"],["type","text","placeholder","Inventario m\xednimo","formControlName","minimumInventory",1,"form-control",3,"keyup.enter"],["type","text","placeholder","Inventario max\xedmo","formControlName","maximumInventory",1,"form-control",3,"keyup.enter"],[1,"btn","btn-primary",3,"disabled","click"],[1,"error-messages"],["class","d-block",4,"ngIf"],[1,"d-block"]],template:function(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"i",3),t.NdJ("click",function(){return n.GoHome()}),t.qZA(),t._uU(4," Mis productos "),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(r);const c=t.MAs(37);return n.modal.OpenModal(c)}),t._UZ(7,"i",6),t._uU(8," Agregar "),t.qZA(),t.TgZ(9,"div",7),t.TgZ(10,"button",8),t._UZ(11,"i",9),t._uU(12," CSV "),t.qZA(),t.TgZ(13,"div",10),t.TgZ(14,"div",11),t.TgZ(15,"div",12),t.NdJ("click",function(){return n.DownloadTemplate()}),t._UZ(16,"i",13),t.TgZ(17,"span",14),t._uU(18,"Descargar plantilla"),t.qZA(),t.qZA(),t.TgZ(19,"div",12),t.NdJ("click",function(){t.CHM(r);const c=t.MAs(33);return n.modal.OpenModal(c)}),t._UZ(20,"i",15),t.TgZ(21,"span",14),t._uU(22,"Subir archivo"),t.qZA(),t.qZA(),t.TgZ(23,"div",12),t.NdJ("click",function(){return n.GenerateCsv()}),t._UZ(24,"i",16),t.TgZ(25,"span",14),t._uU(26,"Exportar productos"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(27,U,2,2,"ng-container",17),t.qZA(),t.YNc(28,w,2,0,"ng-template",null,18,t.W1O),t.YNc(30,M,2,0,"ng-template",null,19,t.W1O),t.YNc(32,B,21,7,"ng-template",null,20,t.W1O),t.YNc(34,O,13,5,"ng-template",null,21,t.W1O),t.YNc(36,ht,116,21,"ng-template",null,22,t.W1O)}if(2&e){const r=t.MAs(29);t.xp6(27),t.Q6J("ngIf",!n.loading.getting)("ngIfElse",r)}},directives:[p.O5,N.b,p.sg,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,h.w9],pipes:[p.JJ],styles:[""]}),o})();var yt=s(3550);const Ct=[{path:"",component:vt}];let At=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[a.u5,p.ez,yt.F,h.A0,a.UX,v.Bz.forChild(Ct)]]}),o})()}}]);