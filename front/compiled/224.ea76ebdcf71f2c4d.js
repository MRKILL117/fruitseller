"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[224],{7224:(U,c,o)=>{o.r(c),o.d(c,{PaymentsModule:()=>P});var l=o(6019),u=o(850),d=o(7537),g=o(1435),p=o(3550),t=o(1514),m=o(6588),_=o(7754),Z=o(1843),f=o(6155),h=o(5749);const T=function(n){return{text:!1,startDate:!0,endDate:!0,options:n,optionsLabel:"Filtrar por estado"}};function v(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"app-filters",22),t.NdJ("onSearch",function(s){return t.CHM(e),t.oxw().GetOrders(s)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("timerTrigger",!0)("filters",t.VKq(2,T,e.orderStatuses))}}function x(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",29),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw(3).ToggleStatusEdition(s)}),t._UZ(1,"i",30),t._uU(2),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.status.name," ")}}function A(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",31),t.TgZ(1,"i",32),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit;return t.oxw(3).SaveOrderStatus(s)}),t.qZA(),t.TgZ(2,"ng-select",33),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().$implicit.statusId=s}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(2),t.Q6J("items",i.orderStatuses)("loading",i.loading.updating)("disabled",i.loading.updating)("ngModel",e.statusId)}}function y(n,a){if(1&n&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t.YNc(4,x,3,1,"div",27),t.YNc(5,A,3,4,"div",28),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"date"),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.qZA(),t.qZA()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Q6J("ngIf",!e.editStatus),t.xp6(1),t.Q6J("ngIf",!!e.editStatus),t.xp6(2),t.Oqu(t.xi3(8,8,e.date,"dd/MM/YYYY hh:mm a")),t.xp6(3),t.Oqu(e.client.name),t.xp6(2),t.hij("$",e.taxes,""),t.xp6(2),t.hij("$",e.subtotal,""),t.xp6(2),t.hij("$",e.total,"")}}function b(n,a){if(1&n&&(t.TgZ(0,"table",24),t.TgZ(1,"thead",25),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4,"#"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Estatus"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Fecha"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Cliente"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Impuestos"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Subtotal"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Total"),t.qZA(),t._UZ(17,"th"),t.qZA(),t.qZA(),t.TgZ(18,"tbody"),t.YNc(19,y,17,11,"tr",26),t.qZA(),t.qZA()),2&n){const e=t.oxw(2);t.xp6(19),t.Q6J("ngForOf",e.orders)}}function q(n,a){if(1&n&&(t.TgZ(0,"div",16),t.YNc(1,b,20,1,"table",23),t.qZA()),2&n){const e=t.oxw(),i=t.MAs(43);t.xp6(1),t.Q6J("ngIf",!(null==e.orders||!e.orders.length))("ngIfElse",i)}}function S(n,a){1&n&&(t.TgZ(0,"div",34),t._UZ(1,"i",35),t.qZA())}function C(n,a){1&n&&(t.TgZ(0,"div",36),t._uU(1," No tiene ordenes por cobrar "),t.qZA())}const O=[{path:"",component:(()=>{class n{constructor(e,i,s,r){this.toast=e,this.http=i,this.csv=s,this.nav=r,this.clients=[],this.orders=[],this.orderStatuses=[],this.loading={updating:!1,getting:!0}}ngOnInit(){this.GetOrderStatuses(),this.GetOrders()}GoHome(){this.nav.GoToRoleRoute("")}GetOrders(e=null){this.loading.getting=!0;let i="/Orders/OfPayments";e&&(i+=`/FilteredBy/StartDate/${e.startDate}/EndDate/${e.endDate}/Statuses/${JSON.stringify(e.options)}`),this.http.Get(i).subscribe(s=>{this.orders=s,this.loading.getting=!1},s=>{console.error("Error getting Orders",s),this.loading.getting=!1})}GetOrderStatuses(){this.http.Get("/OrderStatuses").subscribe(e=>{this.orderStatuses=e.filter(i=>i.id>=3)},e=>{console.error("Error getting order statuses",e)})}GenerateCsv(){let s=this.orders.map(r=>({}));this.csv.GenerateCSV("cobranza",s,["id","status","date","client","taxes","subtotal","total"],["id","Estatus","Fecha","Cliente","Impuestos","Subtotal","Total"])}GetTotalOrdersByStatus(e){let i=0;return this.orders.forEach(s=>{e==s.status.name&&(i+=s.total)}),i}GoToOrder(e){localStorage.setItem("paymentMode",JSON.stringify(!0)),this.nav.GoToRoleRoute("edit-sell-orders/"+e.id)}ToggleStatusEdition(e){e.editStatus=!e.editStatus}SaveOrderStatus(e){e.statusId?(this.loading.updating=!0,this.http.Patch("/Orders",{order:e}).subscribe(i=>{this.toast.ShowDefaultSuccess("Estatus actualizado"),this.ToggleStatusEdition(e),this.GetOrders(),this.loading.updating=!1},i=>{console.error("Error updating order status",i),this.loading.updating=!1})):this.toast.ShowDefaultWarning("Selecciona un status")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.k),t.Y36(_.O),t.Y36(Z.M),t.Y36(f.f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payments"]],decls:44,vars:15,consts:[[1,"content"],[1,"d-flex","align-items-center","justify-content-between"],[1,"page-title"],[1,"zmdi","zmdi-home","zmdi-hc-lg","mr-2","clickeable",3,"click"],[1,"d-flex"],["id","csvordersDropdown","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"clickeable","px-2"],[1,"btn","btn-success","mx-1"],[1,"zmdi","zmdi-file","zmdi-hc-lg","mr-2"],["aria-labelledby","csvordersDropdown",1,"dropdown-menu","px-1","py-1"],[1,"menu-list"],[1,"d-flex","align-items-center","px-3","my-1","clickeable-hover",3,"click"],[1,"zmdi","zmdi-download"],[1,"pl-2"],[1,"row","justify-content-center"],[1,"col-12","mb-4"],[3,"timerTrigger","filters","onSearch",4,"ngIf"],[1,"col-12","col-lg-11"],[1,"total-card"],[1,"total"],["class","col-12 col-lg-11",4,"ngIf","ngIfElse"],["bigLoading",""],["noOrdersMessage",""],[3,"timerTrigger","filters","onSearch"],["class","table table-striped","style","overflow: visible;",4,"ngIf","ngIfElse"],[1,"table","table-striped",2,"overflow","visible"],[1,"table-thead"],[4,"ngFor","ngForOf"],["class","d-flex align-items-center clickeable","style","gap: 12px;",3,"click",4,"ngIf"],["class","d-flex align-items-center","style","gap: 12px;",4,"ngIf"],[1,"d-flex","align-items-center","clickeable",2,"gap","12px",3,"click"],[1,"zmdi","zmdi-edit","zmdi-hc-lg"],[1,"d-flex","align-items-center",2,"gap","12px"],[1,"zmdi","zmdi-save","zmdi-hc-lg","clickeable",3,"click"],["bindLabel","name","bindValue","id","placeholder","Selecciona un estatus",1,"flex-grow-1",3,"items","loading","disabled","ngModel","ngModelChange"],[1,"w-100","h-75","d-flex","align-items-center","justify-content-center",2,"min-height","min-content"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"],[1,"no-items-message"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"i",3),t.NdJ("click",function(){return i.GoHome()}),t.qZA(),t._uU(4," Cobranza "),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t.TgZ(7,"button",6),t._UZ(8,"i",7),t._uU(9," CSV "),t.qZA(),t.TgZ(10,"div",8),t.TgZ(11,"div",9),t.TgZ(12,"div",10),t.NdJ("click",function(){return i.GenerateCsv()}),t._UZ(13,"i",11),t.TgZ(14,"span",12),t._uU(15,"Exportar ordenes"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"div",13),t.TgZ(17,"div",14),t.YNc(18,v,1,4,"app-filters",15),t.qZA(),t.TgZ(19,"div",16),t.TgZ(20,"div",17),t.TgZ(21,"div",18),t.TgZ(22,"span"),t._uU(23,"Pendientes:"),t.qZA(),t.TgZ(24,"span"),t._uU(25),t.ALo(26,"number"),t.qZA(),t.qZA(),t.TgZ(27,"div",18),t.TgZ(28,"span"),t._uU(29,"Pagadas:"),t.qZA(),t.TgZ(30,"span"),t._uU(31),t.ALo(32,"number"),t.qZA(),t.qZA(),t.TgZ(33,"div",18),t.TgZ(34,"span"),t._uU(35,"Incobrables:"),t.qZA(),t.TgZ(36,"span"),t._uU(37),t.ALo(38,"number"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(39,q,2,2,"div",19),t.qZA(),t.qZA(),t.YNc(40,S,2,0,"ng-template",null,20,t.W1O),t.YNc(42,C,2,0,"ng-template",null,21,t.W1O)),2&e){const s=t.MAs(41);t.xp6(18),t.Q6J("ngIf",!!i.orderStatuses.length),t.xp6(7),t.hij("$",t.xi3(26,6,i.GetTotalOrdersByStatus("Pendiente de pago"),"0.2-2"),""),t.xp6(6),t.hij("$",t.xi3(32,9,i.GetTotalOrdersByStatus("Pagado"),"0.2-2"),""),t.xp6(6),t.hij("$",t.xi3(38,12,i.GetTotalOrdersByStatus("Incobrable"),"0.2-2"),""),t.xp6(2),t.Q6J("ngIf",!i.loading.getting)("ngIfElse",s)}},directives:[l.O5,h.b,l.sg,g.w9,d.JJ,d.On],pipes:[l.JJ,l.uU],styles:[".total-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border:1px solid #ccc;border-radius:12px;margin:1rem 0;padding:1.5rem}.total[_ngcontent-%COMP%]{display:flex;grid-gap:12px;gap:12px;font-size:2rem}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-weight:700}"]}),n})()}];let P=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.u5,l.ez,p.F,g.A0,d.UX,u.Bz.forChild(O)]]}),n})()}}]);